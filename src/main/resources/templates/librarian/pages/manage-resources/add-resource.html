<!-- templates/add-librarian.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

    <head>
        <meta charset="UTF-8">
        <title>Add Resource</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    </head>

    <body class="bg-light">

        <div th:replace="librarian/fragments/navbar :: navbar"></div>


        <div class="row justify-content-center" style="max-width: 100vw;">


            <!-- Main content -->
            <div class="col-md-9 col-lg-10">
                <div class="card shadow-sm p-4 mt-3">
                    <h2>Add New Resource</h2>
                    <form th:action="@{/librarian/manage-resources/add}" th:object="${addResourcePayload}" method="post" enctype="multipart/form-data">

                        <div class="mb-3">
                            <label class="form-label">Title</label>
                            <input type="text"
                                   th:field="*{title}"
                                   class="form-control"
                                   placeholder="Enter resource title"
                                   required
                            >
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Author</label>
                            <input type="text"
                                   th:field="*{author}"
                                   class="form-control"
                                   placeholder="Enter author name"
                                   required>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Category</label>
                            <select th:field="*{category}" class="form-select" required>
                                <option value="" disabled selected>Select category</option>
                                <option th:each="c : ${T(com.platform.libraryManager.shared.enums.ResourceCategoryEnum).values()}"
                                        th:value="${c}"
                                        th:text="${c}">
                                </option>
                            </select>
                        </div>


                        <div class="mb-3">
                            <label class="form-label">Type</label>
                            <select th:field="*{type}" class="form-select" required>
                                <option value="" disabled selected>Select type</option>
                                <option th:each="t : ${T(com.platform.libraryManager.shared.enums.ResourceTypeEnum).values()}"
                                        th:value="${t}"
                                        th:text="${t}">
                                </option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Resource File</label>
                            <input type="file"
                                   class="form-control"
                                   name="file"
                                   accept="image/*,.pdf"
                                   onchange="previewFile(event)"
                                   required>
                        </div>

                        <div class="mb-3 text-center">
                            <img id="filePreview"
                                 class="img-fluid d-none border rounded"
                                 style="max-height: 200px;" />
                            <p id="fileName" class="mt-2 text-muted"></p>
                        </div>

                        <div class="mt-3">
                            <button type="submit" class="btn btn-primary">Add Resource</button>
                            <a th:href="@{/librarian/dashboard}" class="btn btn-secondary">Cancel</a>
                        </div>


                    <div class="mt-3 text-center text-danger" th:text="${message}"></div>
                </div>
            </div>

        </div>

        <div th:replace="librarian/fragments/footer :: footer"></div>




        <script>
            function previewFile(event) {
                const file = event.target.files[0];
                const preview = document.getElementById("filePreview");
                const fileName = document.getElementById("fileName");

                if (!file) return;

                fileName.textContent = file.name;

                if (file.type.startsWith("image/")) {
                    preview.src = URL.createObjectURL(file);
                    preview.classList.remove("d-none");
                } else preview.classList.add("d-none");
            }
        </script>


    </body>

</html>